From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Ziggleflig <dmdinnc@gmail.com>
Date: Sun, 1 May 2022 00:46:53 -0400
Subject: [PATCH] Monumenta - Fix shulker NoAI allowing peeking


diff --git a/src/main/java/net/minecraft/world/entity/monster/Shulker.java b/src/main/java/net/minecraft/world/entity/monster/Shulker.java
index a9dfe190f46230077e2e1bf9aacbf5375651f216..1077cc08b0f716300d7c278bb345a25d72cb1cbe 100644
--- a/src/main/java/net/minecraft/world/entity/monster/Shulker.java
+++ b/src/main/java/net/minecraft/world/entity/monster/Shulker.java
@@ -94,6 +94,7 @@ public class Shulker extends AbstractGolem implements Enemy {
 
     @Override
     protected void registerGoals() {
+        if (this.isNoAi()) return;
         this.goalSelector.addGoal(1, new LookAtPlayerGoal(this, Player.class, 8.0F, 0.02F, true));
         this.goalSelector.addGoal(4, new Shulker.ShulkerAttackGoal());
         this.goalSelector.addGoal(7, new Shulker.ShulkerPeekGoal());
@@ -175,7 +176,7 @@ public class Shulker extends AbstractGolem implements Enemy {
     @Override
     public void tick() {
         super.tick();
-        if (!this.level.isClientSide && !this.isPassenger() && !this.canStayAt(this.blockPosition(), this.getAttachFace())) {
+        if (!this.level.isClientSide && !this.isPassenger() && !this.canStayAt(this.blockPosition(), this.getAttachFace()) && !this.isNoAi()) {
             this.findNewAttachment();
         }
 
@@ -235,6 +236,10 @@ public class Shulker extends AbstractGolem implements Enemy {
     }
 
     private void onPeekAmountChange() {
+        if (this.isNoAi()) {
+            this.currentPeekAmount = 0;
+            this.currentPeekAmountO = 0;
+        }
         this.reapplyPosition();
         float f = Shulker.getPhysicalPeek(this.currentPeekAmount);
         float f1 = Shulker.getPhysicalPeek(this.currentPeekAmountO);
